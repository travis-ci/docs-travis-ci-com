
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Travis CI - API Reference</title>

    <link href="/api/stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/api/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
    <script src="//code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="/api/javascripts/all.js" type="text/javascript"></script>

    <script>
      $(function() {
        var toc = $("#toc").tocify({
          selectors: "h1,h2",
          extendPage: false,
          theme: "none",
          smoothScroll: false,
          showEffectSpeed: 0,
          hideEffectSpeed: 180,
          ignoreSelector: ".toc-ignore",
          hashGenerator: 'pretty',
          highlightOffset: 60,
          scrollTo: -2,
          scrollHistory: true,
          hashGenerator: function(text, element) {
            return element[0].getAttribute('id');
          }
        }).data("toc-tocify");
        // Hack to make already open sections to start opened,
        // instead of displaying an ugly animation
        setTimeout(function() {
          toc.setOption("showEffectSpeed", 180);
        },50);
        setupLanguages([



                'http',



                'shell',



                'ruby',



        ]);
      });
    </script>
  </head>

  <body class="index">
    <div class="tocify-wrapper">
      <p><img src="/api/images/logo.png" alt="The Travis CI logo"/></p>
      <div id="toc">
      </div>

      <ul class="toc-footer">

          <li><a href='https://travis-ci.org'>Travis CI for Open Source</a></li>

          <li><a href='https://travis-ci.com'>Travis CI for Private Projects</a></li>

      </ul>
      <div class="toc-copyright">
        &copy; 2015 Travis CI GmbH<br>
        Rigaerstr. 8,<br>
        10247 Berlin, Germany
      </div>

    </div>
    <div class="page-wrapper">
      <div class="content">
        <h1 id="overview">Overview</h1>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token "YOUR TRAVIS ACCESS TOKEN"</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.com</span>
</pre>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/api</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token "YOUR TRAVIS ACCESS TOKEN"</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">travis.example.com</span>
</pre>
<pre class="highlight shell"><span class="gp">$ </span>travis raw /
<span class="o">{</span><span class="s2">"hello"</span><span class="o">=</span>&gt;<span class="s2">"world"</span><span class="o">}</span>

<span class="gp">$ </span>travis raw / --pro
<span class="o">{</span><span class="s2">"hello"</span><span class="o">=</span>&gt;<span class="s2">"world"</span><span class="o">}</span>

<span class="gp">$ </span>travis raw / --api-endpoint https://travis.example.com/api
<span class="o">{</span><span class="s2">"hello"</span><span class="o">=</span>&gt;<span class="s2">"world"</span><span class="o">}</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="c1"># talk to travis-ci.org via client object</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span>
<span class="n">repository</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">repo</span><span class="p">(</span><span class="s1">'travis-ci/travis.rb'</span><span class="p">)</span>

<span class="c1"># talk to travis-ci.org via Travis namespace</span>
<span class="n">repository</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'travis-ci/travis.rb'</span><span class="p">)</span>

<span class="c1"># talk to travis-ci.com via client object</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'https://api.travis-ci.com'</span><span class="p">)</span>
<span class="n">client</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="n">repository</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">repo</span><span class="p">(</span><span class="s1">'travis-pro/billing'</span><span class="p">)</span>

<span class="c1"># talk to travis-ci.com via Travis::Pro namespace</span>
<span class="no">Travis</span><span class="o">::</span><span class="no">Pro</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="n">repository</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Pro</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'travis-pro/billing'</span><span class="p">)</span>

<span class="c1"># talk to travis.example.com via client object</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'https://travis.example.com/api'</span><span class="p">)</span>
<span class="n">client</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="n">repository</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">repo</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">)</span>

<span class="c1"># talk to travis.example.com via custom namespace</span>
<span class="no">My</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="o">::</span><span class="no">Namespaces</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'https://travis.example.com/api'</span><span class="p">)</span>
<span class="no">My</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="no">My</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">)</span>
</pre>

<p>Welcome to the Travis CI API documentation. This is the API used by the official Travis CI web interface, so everything the web ui is able to do can also be accomplished via the API.</p>

<p>The first thing you will have to find out is the correct API endpoint to use.</p>

<ul>
<li><strong>Travis CI for open source:</strong> For open source projects tested on <a href="https://travis-ci.org">travis-ci.org</a>, use <strong><a href="https://api.travis-ci.org">https://api.travis-ci.org</a></strong>.</li>
<li><strong>Travis Pro:</strong> For private projects tested on <a href="https://travis-ci.com">travis-ci.com</a>, use <strong><a href="https://api.travis-ci.com">https://api.travis-ci.com</a></strong>.</li>
<li><strong>Travis Enterprise:</strong> For projects running on a custom setup, use <strong><a href="https://travis.example.com/api">https://travis.example.com/api</a></strong> (where you replace travis.example.com with the domain Travis CI is running on).</li>
</ul>

<p>Note that both Pro and Enterprise will require almost all API calls to be <a href="#authentication">authenticated</a>.</p>

<h1 id="making-requests">Making Requests</h1>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="s2">"hello"</span><span class="p">:</span><span class="s2">"world"</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis raw /
<span class="o">{</span><span class="s2">"hello"</span>:<span class="s2">"world"</span><span class="o">}</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="c1"># You usually don't want to fire API requests manually</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span>
<span class="n">client</span><span class="p">.</span><span class="nf">get_raw</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span> <span class="c1"># =&gt; {"hello"=&gt;"world"}</span>

<span class="n">client</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/repos/sinatra/sinatra'</span><span class="p">)</span>
<span class="c1"># =&gt; {"repo"=&gt;#&lt;Travis::Client::Repository: sinatra/sinatra&gt;}</span>
</pre>

<p><aside class="warning">
  If you do not set the <strong>Accept</strong> header, you might retrieve our old API formats. These are deprecated and will be removed soon.
</aside></p>

<p>When you write your own Travis CI client, please keep the following in mind:</p>

<ul>
<li>Always set the <strong>User-Agent</strong> header. This header is not required right now, but will be in the near future. Assuming your client is called &ldquo;My Client&rdquo;, and it&rsquo;s current version is 1.0.0, a good value would be <code class="prettyprint">MyClient/1.0.0</code>. For our command line client running on OS X 10.9 on Ruby 2.1.1, it might look like this: <code class="prettyprint">Travis/1.6.8 (Mac OS X 10.9.2 like Darwin; Ruby 2.1.1; RubyGems 2.0.14) Faraday/0.8.9 Typhoeus/0.6.7</code>.</li>
<li>Always set the <strong>Accept</strong> header to <code class="prettyprint">application/vnd.travis-ci.2+json</code>.</li>
</ul>

<p>Any existing client library should take care of these for you.</p>

<h1 id="external-apis">External APIs</h1>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/config</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"config"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"travis-ci.org"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pusher"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5df8ac576dcccf4fd076"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"github"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"api_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.github.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"scopes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"read:org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user:email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"repo_deployment"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"repo:status"</span><span class="p">,</span><span class="w"> </span><span class="s2">"write:repo_hook"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis raw /config
<span class="o">{</span><span class="s2">"config"</span><span class="o">=</span>&gt;
  <span class="o">{</span><span class="s2">"host"</span><span class="o">=</span>&gt;<span class="s2">"travis-ci.org"</span>,
   <span class="s2">"pusher"</span><span class="o">=</span>&gt;<span class="o">{</span><span class="s2">"key"</span><span class="o">=</span>&gt;<span class="s2">"5df8ac576dcccf4fd076"</span><span class="o">}</span>,
   <span class="s2">"github"</span><span class="o">=</span>&gt;
    <span class="o">{</span><span class="s2">"api_url"</span><span class="o">=</span>&gt;<span class="s2">"https://api.github.com"</span>,
     <span class="s2">"scopes"</span><span class="o">=</span>&gt;
      <span class="o">[</span><span class="s2">"read:org"</span>,
       <span class="s2">"user:email"</span>,
       <span class="s2">"repo_deployment"</span>,
       <span class="s2">"repo:status"</span>,
       <span class="s2">"write:repo_hook"</span><span class="o">]}}}</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span>
<span class="n">client</span><span class="p">.</span><span class="nf">config</span>
<span class="c1"># =&gt; {"host"=&gt;"travis-ci.org",</span>
<span class="c1">#     "pusher"=&gt;{"key"=&gt;"5df8ac576dcccf4fd076"},</span>
<span class="c1">#     "github"=&gt;</span>
<span class="c1">#      {"api_url"=&gt;"https://api.github.com",</span>
<span class="c1">#       "scopes"=&gt;</span>
<span class="c1">#        ["read:org",</span>
<span class="c1">#         "user:email",</span>
<span class="c1">#         "repo_deployment",</span>
<span class="c1">#         "repo:status",</span>
<span class="c1">#         "write:repo_hook"]}}</span>
</pre>

<p>Travis CI integrates with external services, some of which your client library might want to interface with directly.
Most prominently, it uses GitHub as source for users, organizations and repositories, and Pusher for live streaming logs.</p>

<p>You can ask the API for the connection details to these services by loading the <code class="prettyprint">config</code> endpoint.</p>

<p>This includes, amongst other things:</p>

<ul>
<li>The GitHub API endpoint (this might be a GitHub enterprise endpoint) and the GitHub scopes currently required by Travis CI. These are the scopes you should use when <a href="#creating-a-temporary-github-token">generating a temporary GitHub token</a> for authentication.</li>
<li>The <a href="http://pusher.com/">Pusher</a> application key. If the setup is running behind a firewall and uses <a href="https://github.com/stevegraham/slanger">Slanger</a>, it will also include the Slanger URL.</li>
</ul>

<h1 id="authentication">Authentication</h1>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/users</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token "YOUR TRAVIS ACCESS TOKEN"</span>
</pre>
<pre class="highlight shell"><span class="gp">$ </span>travis whoami -t <span class="s2">"YOUR TRAVIS ACCESS TOKEN"</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="c1"># against the Travis namespace</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="no">Travis</span><span class="o">::</span><span class="no">User</span><span class="p">.</span><span class="nf">current</span>

<span class="c1"># against a client object</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">access_token: </span><span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span><span class="p">)</span>
<span class="n">client</span><span class="p">.</span><span class="nf">user</span>
</pre>

<p><aside class="notice">
Do not confuse the <i>access token</i> with the token found on your profile page.
</aside></p>

<p>To authenticate against Travis CI, you need an API access token.</p>

<p>You can retrieve a token by using a GitHub token to prove who you are. In the future, we are planning to add a proper OAuth handshake for third party applications.</p>

<h2 id="with-a-github-token">With a GitHub token</h2>
<pre class="highlight http"><span class="nf">POST</span> <span class="nn">/auth/github</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">37</span>

<span class="p">{</span><span class="s2">"github_token"</span><span class="p">:</span><span class="s2">"YOUR GITHUB TOKEN"</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="s2">"access_token"</span><span class="p">:</span><span class="s2">"YOUR TRAVIS ACCESS TOKEN"</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis login --github-token <span class="s2">"YOUR GITHUB TOKEN"</span>
Successfully logged <span class="k">in</span>!

<span class="gp">$ </span>travis token
Your access token is YOUR TRAVIS ACCESS TOKEN
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="c1"># against the Travis namespace</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">github_auth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

<span class="c1"># against a client object</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span>
<span class="n">client</span><span class="p">.</span><span class="nf">github_auth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</pre>

<p>If you have a GitHub token, you can use the GitHub authentication endpoint to exchange it for an access token.
The Travis API server will not store the token or use it for anything else then verifying the user account.</p>

<p>Note that therefore the API cannot be used to create new user accounts. The user will have to log in at least once via the web interface before interfacing with the API by other means.</p>

<h2 id="creating-a-temporary-github-token">Creating a temporary GitHub token</h2>
<pre class="highlight http"><span class="nf">POST</span> <span class="nn">/authorizations</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.github.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Basic ...</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"scopes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"read:org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user:email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"repo_deployment"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"repo:status"</span><span class="p">,</span><span class="w"> </span><span class="s2">"write:repo_hook"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"temporary token to auth against travis"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.github.com/authorizations/1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scopes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"read:org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user:email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"repo_deployment"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"repo:status"</span><span class="p">,</span><span class="w"> </span><span class="s2">"write:repo_hook"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YOUR GITHUB TOKEN"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"temporary token to auth against travis"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight http"><span class="nf">POST</span> <span class="nn">/auth/github</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">37</span>

<span class="p">{</span><span class="s2">"github_token"</span><span class="p">:</span><span class="s2">"YOUR GITHUB TOKEN"</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="s2">"access_token"</span><span class="p">:</span><span class="s2">"YOUR TRAVIS ACCESS TOKEN"</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight http"><span class="nf">DELETE</span> <span class="nn">/authorizations/1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.github.com</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Basic ...</span>
</pre>
<pre class="highlight shell"><span class="gp">$ </span>travis login --auto
Successfully logged <span class="k">in</span>!

<span class="gp">$ </span>travis token
Your access token is YOUR TRAVIS ACCESS TOKEN
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="nb">require</span> <span class="s1">'travis/tools/github'</span>

<span class="c1"># drop_token will make the token a temporary one</span>
<span class="n">github</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Tools</span><span class="o">::</span><span class="no">Github</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">drop_token: </span><span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">ask_login</span>    <span class="o">=</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="nb">print</span><span class="p">(</span><span class="s2">"GitHub login:     "</span><span class="p">);</span> <span class="nb">gets</span> <span class="p">}</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">ask_password</span> <span class="o">=</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Password:         "</span><span class="p">);</span> <span class="nb">gets</span> <span class="p">}</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">ask_otp</span>      <span class="o">=</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Two-factor token: "</span><span class="p">);</span> <span class="nb">gets</span> <span class="p">}</span>
<span class="k">end</span>

<span class="n">github</span><span class="p">.</span><span class="nf">with_token</span> <span class="k">do</span> <span class="o">|</span><span class="n">token</span><span class="o">|</span>
  <span class="no">Travis</span><span class="p">.</span><span class="nf">github_auth</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="k">end</span>

<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="c1"># =&gt; "YOUR TRAVIS ACCESS TOKEN"</span>
</pre>

<p>Since Travis CI will not store the GitHub token handed to it for authentication, it is possible to generate a temporary GitHub token and remove it again after the authentication handshake.</p>

<p>To create and delete the GitHub token, you can either use the <a href="https://github.com/settings/applications">GitHub web interface</a> or automate it via the <a href="https://developer.github.com/v3/oauth_authorizations/#create-a-new-authorization">GitHub API</a>.</p>

<p>Make sure your GitHub token has the scopes <a href="#external-apis">required</a> by Travis CI.</p>

<p>If you automate this process, authentication will become a handshake consisting of three requests:</p>

<ul>
<li>Create a GitHub token via the GitHub API, store GitHub token and URL.</li>
<li>Use the <code class="prettyprint">/auth/github</code> endpoint to exchange it for an access token. Store the access token.</li>
<li>Delete the GitHub token via the GitHub API.</li>
</ul>

<p>Some client libraries will automate this handshake for you.</p>

<h2 id="github-oauth-handshake">GitHub OAuth handshake</h2>

<blockquote>
<p>Triggering an OAuth handshake between GitHub and Travis CI:</p>
</blockquote>
<pre class="highlight html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://api.travis-ci.com/auth/handshake"</span><span class="nt">&gt;</span>log in<span class="nt">&lt;/a&gt;</span>
</pre>

<blockquote>
<p>Running the OAuth handshake in an iframe:</p>
</blockquote>
<pre class="highlight html"><span class="nt">&lt;script&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"message"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"received token: "</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;iframe /&gt;'</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
  <span class="nx">iframe</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>
  <span class="nx">iframe</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'src'</span><span class="p">,</span> <span class="s2">"https://api.travis-ci.org/auth/post_message"</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre>

<p>You can also trigger a full OAuth handshake between Travis CI and GitHub by opening <code class="prettyprint">/auth/handshake</code> in a web browser. The endpoint takes an optional <code class="prettyprint">redirect_uri</code> query parameter, which takes a URL the web browser will end up on if the handshake is successful.</p>

<p>There is an alternative version of this that will try to run the handshake in a hidden iframe and using <code class="prettyprint">window.postMessage</code> to hand the token to the website embedding the iframe. <strong>This endpoint will only work for whitelisted websites.</strong></p>

<h1 id="entities">Entities</h1>

<h2 id="accounts">Accounts</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/accounts</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token "YOUR TRAVIS ACCESS TOKEN"</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
   </span><span class="s2">"accounts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"repos_count"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">167</span><span class="p">,</span><span class="w">
         </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Konstantin Haase"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">267</span><span class="p">,</span><span class="w">
         </span><span class="s2">"login"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"rkh"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"repos_count"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w">
         </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Travis CI"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"organization"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">87</span><span class="p">,</span><span class="w">
         </span><span class="s2">"login"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"travis-ci"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis accounts
rkh <span class="o">(</span>Konstantin Haase<span class="o">)</span>: subscribed, 167 repositories
travis-ci <span class="o">(</span>Travis CI<span class="o">)</span>: subscribed, 70 repositories
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>

<span class="no">Travis</span><span class="p">.</span><span class="nf">accounts</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">account</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">account</span><span class="p">.</span><span class="nf">login</span><span class="si">}</span><span class="s2"> has </span><span class="si">#{</span><span class="n">account</span><span class="p">.</span><span class="nf">repos_count</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</pre>

<p>A user might have access to multiple accounts. This is usually the account corresponding to the user directly and one account per GitHub organization.</p>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>user or organization id</td>
</tr>
<tr>
<td>name</td>
<td>account name on GitHub</td>
</tr>
<tr>
<td>login</td>
<td>account login on GitHub</td>
</tr>
<tr>
<td>type</td>
<td><code class="prettyprint">user</code> or <code class="prettyprint">organization</code></td>
</tr>
<tr>
<td>repos_count</td>
<td>number of repositories</td>
</tr>
<tr>
<td>subscribed</td>
<td>whether or not the account has a valid subscription</td>
</tr>
</tbody></table>

<p>The <code class="prettyprint">subscribed</code> attribute is only available on Travis Pro.</p>

<h3 id="list-accounts">List accounts</h3>

<p><code class="prettyprint">GET /accounts</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>all</td>
<td>false</td>
<td>whether or not to include accounts the user does not have admin access to</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h2 id="annotations">Annotations</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/jobs/42/annotations</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
   </span><span class="s2">"annotations"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="w">          </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"job_id"</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"foo bar"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="w">         </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/job-42"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis show <span class="c"># job info will include annotations</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="n">job</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Job</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">job</span><span class="p">.</span><span class="nf">annotations</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">annotation</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">annotation</span><span class="p">.</span><span class="nf">description</span>
<span class="k">end</span>
</pre>

<p><aside class="warning">
  Annotation support is experimental.
</aside></p>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>annotation id</td>
</tr>
<tr>
<td>job_id</td>
<td>job id the annotation is for</td>
</tr>
<tr>
<td>description</td>
<td>textual description of the annotation</td>
</tr>
<tr>
<td>url</td>
<td>url with more information</td>
</tr>
<tr>
<td>status</td>
<td>annotation status</td>
</tr>
</tbody></table>

<h3 id="list-annotations">List Annotations</h3>

<p><code class="prettyprint">GET /jobs/{job.id}/annotations</code></p>

<h3 id="create-annotation">Create Annotation</h3>

<p><code class="prettyprint">POST /jobs/{job.id}/annotations</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>username</td>
<td></td>
<td>user name for provider authentication</td>
</tr>
<tr>
<td>key</td>
<td></td>
<td>secret key for provider authentication</td>
</tr>
<tr>
<td>description</td>
<td></td>
<td>textual description of the annotation</td>
</tr>
<tr>
<td>url</td>
<td></td>
<td>url with more information</td>
</tr>
<tr>
<td>status</td>
<td></td>
<td>annotation status</td>
</tr>
</tbody></table>

<h2 id="branches">Branches</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/rails/rails/branches</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"branches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22554234</span><span class="p">,</span><span class="w">
      </span><span class="s2">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">891</span><span class="p">,</span><span class="w">
      </span><span class="s2">"commit_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6534402</span><span class="p">,</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15184"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"config"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"started_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-08T00:17:34Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"finished_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-08T00:48:59Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"duration"</span><span class="p">:</span><span class="w"> </span><span class="mi">30546</span><span class="p">,</span><span class="w">
      </span><span class="s2">"job_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="s2">"pull_request"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis branches -r rails/rails
v4.1.0:         <span class="c">#15184 created  Dont encourage aliases now that …</span>
master:         <span class="c">#15183 created  Dont abbreviate that which needs…</span>
4-1-0:          <span class="c">#15183 created  Dont encourage aliases now that …</span>
4-1-stable:     <span class="c">#15185 created  Merge branch '4-1-0' into 4-1-st…</span>
adequaterecord: <span class="c">#15158 passed   wrap the literal value before ha…</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="n">repository</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'rails/rails'</span><span class="p">)</span>
<span class="n">repository</span><span class="p">.</span><span class="nf">branches</span>
<span class="c1"># =&gt; {"v4.1.0"          =&gt; #&lt;Travis::Client::Build: rails/rails#15184&gt;,</span>
<span class="c1">#      "master"         =&gt; #&lt;Travis::Client::Build: rails/rails#15183&gt;,</span>
<span class="c1">#      "4-1-0"          =&gt; #&lt;Travis::Client::Build: rails/rails#15183&gt;,</span>
<span class="c1">#      "4-1-stable"     =&gt; #&lt;Travis::Client::Build: rails/rails#15185&gt;,</span>
<span class="c1">#      "adequaterecord" =&gt; #&lt;Travis::Client::Build: rails/rails#15158&gt;,</span>
<span class="c1">#      "4-0-stable"     =&gt; #&lt;Travis::Client::Build: rails/rails#15143&gt;}</span>
</pre>

<p>The branches API can be used to get information about the latest build on a given branch.</p>

<h3 id="attributes">Attributes</h3>

<p>See <a href="#builds">builds</a>.</p>

<h3 id="list-branches">List Branches</h3>

<p>This will list the latest 25 branches.</p>

<p><code class="prettyprint">GET /repos/{repository.id}/branches</code></p>

<p><code class="prettyprint">GET /repos/{+repository.slug}/branches</code></p>

<h3 id="show-branch">Show Branch</h3>

<p><code class="prettyprint">GET /repos/{repository.id}/branches/{branch}</code></p>

<p><code class="prettyprint">GET /repos/{+repository.slug}/branches/{branch}</code></p>

<h2 id="broadcasts">Broadcasts</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/broadcasts</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"broadcasts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"We're switching our build infrastructure on April 29."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis raw /broadcasts
<span class="o">{</span><span class="s2">"broadcasts"</span><span class="o">=</span>&gt;[<span class="o">{</span><span class="s2">"id"</span><span class="o">=</span>&gt;451, <span class="s2">"message"</span><span class="o">=</span>&gt;<span class="s2">"This is a broadcast!"</span><span class="o">}]}</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="no">Travis</span><span class="o">::</span><span class="no">Broadcast</span><span class="p">.</span><span class="nf">current</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">broadcast</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">broadcast</span><span class="p">.</span><span class="nf">message</span>
<span class="k">end</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>broadcast id</td>
</tr>
<tr>
<td>message</td>
<td>broadcast message</td>
</tr>
</tbody></table>

<h3 id="list-broadcasts">List Broadcasts</h3>

<p><code class="prettyprint">GET /broadcasts</code></p>

<p>This request always needs to be authenticated.</p>

<h2 id="builds">Builds</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/sinatra/sinatra/builds</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"builds"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"commit_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6534711</span><span class="p">,</span><span class="w">
      </span><span class="s2">"config"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"duration"</span><span class="p">:</span><span class="w"> </span><span class="mi">2648</span><span class="p">,</span><span class="w">
      </span><span class="s2">"finished_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-08T19:52:56Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22555277</span><span class="p">,</span><span class="w">
      </span><span class="s2">"job_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">22555278</span><span class="p">,</span><span class="w"> </span><span class="mi">22555279</span><span class="p">,</span><span class="w"> </span><span class="mi">22555280</span><span class="p">,</span><span class="w"> </span><span class="mi">22555281</span><span class="p">],</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"784"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pull_request"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pull_request_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1912"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pull_request_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example PR"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">82</span><span class="p">,</span><span class="w">
      </span><span class="s2">"started_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-08T19:37:44Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"failed"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"jobs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"commits"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis <span class="nb">history</span>
...
<span class="gp">$ </span>travis show 15 <span class="c"># show build #15</span>
...
<span class="gp">$ </span>travis restart 15
...
<span class="gp">$ </span>travis cancel 15
...
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>

<span class="n">repository</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">)</span>
<span class="n">repository</span><span class="p">.</span><span class="nf">each_build</span> <span class="k">do</span> <span class="o">|</span><span class="n">build</span><span class="o">|</span>
  <span class="c1"># restart all the builds</span>
  <span class="n">build</span><span class="p">.</span><span class="nf">restart</span>
<span class="k">end</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>build id</td>
</tr>
<tr>
<td>repository_id</td>
<td>repository id</td>
</tr>
<tr>
<td>commit_id</td>
<td>commit id</td>
</tr>
<tr>
<td>number</td>
<td>build number</td>
</tr>
<tr>
<td>pull_request</td>
<td>true or false</td>
</tr>
<tr>
<td>pull_request_title</td>
<td>PR title if pull_request is true</td>
</tr>
<tr>
<td>pull_request_number</td>
<td>PR number if  pull_request is true</td>
</tr>
<tr>
<td>config</td>
<td>build config (secure values and ssh key removed)</td>
</tr>
<tr>
<td>state</td>
<td>build state</td>
</tr>
<tr>
<td>started_at</td>
<td>time the build was started</td>
</tr>
<tr>
<td>finished_at</td>
<td>time the build finished</td>
</tr>
<tr>
<td>duration</td>
<td>build duration</td>
</tr>
<tr>
<td>job_ids</td>
<td>list of job ids in the build matrix</td>
</tr>
</tbody></table>

<p>Note that <code class="prettyprint">duration</code> might not correspond to <code class="prettyprint">finished_at - started_at</code> if the build was restarted at a later point.</p>

<h3 id="list-builds">List Builds</h3>

<p><code class="prettyprint">GET /builds</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td></td>
<td>list of build ids to fetch</td>
</tr>
<tr>
<td>repository_id</td>
<td></td>
<td>repository id the build belongs to</td>
</tr>
<tr>
<td>slug</td>
<td></td>
<td>repository slug the build belongs to</td>
</tr>
<tr>
<td>number</td>
<td></td>
<td>filter by build number, requires slug or repository_id</td>
</tr>
<tr>
<td>after_number</td>
<td></td>
<td>list build after a given build number (use for pagination), requires slug or repository_id</td>
</tr>
<tr>
<td>event_type</td>
<td></td>
<td>limit build to given event type (<code class="prettyprint">push</code> or <code class="prettyprint">pull_request</code>)</td>
</tr>
</tbody></table>

<p>You have to supply either <code class="prettyprint">ids</code>, <code class="prettyprint">repository_id</code> or <code class="prettyprint">slug</code>.</p>

<p><code class="prettyprint">GET /repos/{repository.id}/builds</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td></td>
<td>filter by build number</td>
</tr>
<tr>
<td>after_number</td>
<td></td>
<td>list build after a given build number (use for pagination)</td>
</tr>
<tr>
<td>event_type</td>
<td></td>
<td>limit build to given event type (<code class="prettyprint">push</code> or <code class="prettyprint">pull_request</code>)</td>
</tr>
</tbody></table>

<p><code class="prettyprint">GET /repos/{+repository.slug}/builds</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td></td>
<td>filter by build number</td>
</tr>
<tr>
<td>after_number</td>
<td></td>
<td>list build after a given build number (use for pagination)</td>
</tr>
<tr>
<td>event_type</td>
<td></td>
<td>limit build to given event type (<code class="prettyprint">push</code> or <code class="prettyprint">pull_request</code>)</td>
</tr>
</tbody></table>

<h3 id="show-build">Show Build</h3>

<p><code class="prettyprint">GET /builds/{build.id}</code></p>

<p><code class="prettyprint">GET /repos/{repository.id}/builds/{build.id}</code></p>

<p><code class="prettyprint">GET /repos/{+repository.slug}/builds/{build.id}</code></p>

<h3 id="cancel-build">Cancel Build</h3>

<p><code class="prettyprint">POST /builds/{build.id}/cancel</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="restart-build">Restart Build</h3>

<p><code class="prettyprint">POST /builds/{build.id}/restart</code></p>

<p>This request always needs to be authenticated.</p>

<h2 id="caches">Caches</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/travis-pro/billing/caches</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.com</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"caches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">51007</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">103677795</span><span class="p">,</span><span class="w">
      </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cache--rvm-2.0.0--gemfile-Gemfile"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"branch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"master"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last_modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-06T16:19:49Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis cache -r travis-pro/billing
On branch master:
cache--rvm-2.0.0--gemfile-Gemfile  last modified: 2014-03-06 11:19:49  size: 98.87 MiB

On branch mm-ruby-2.1:
cache--rvm-2.0.0--gemfile-Gemfile  last modified: 2013-12-28 09:42:21  size: 98.87 MiB
cache--rvm-2.1.0--gemfile-Gemfile  last modified: 2013-12-28 09:42:21  size: 88.02 MiB

Overall size of above caches: 371.08 MiB

<span class="gp">$ </span>travis cache -r travis-pro/billing --delete --branch mm-ruby-2.1
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="n">repository</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'travis-pro/billing'</span><span class="p">)</span>
<span class="n">repository</span><span class="p">.</span><span class="nf">caches</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">cache</span><span class="o">|</span>
  <span class="c1"># delete all caches!</span>
  <span class="n">cache</span><span class="p">.</span><span class="nf">delete</span> <span class="k">if</span> <span class="n">cache</span><span class="p">.</span><span class="nf">branch</span> <span class="o">==</span> <span class="s1">'mm-ruby-2.1'</span>
<span class="k">end</span>

<span class="c1"># or in a single request</span>
<span class="n">repository</span><span class="p">.</span><span class="nf">delete_caches</span><span class="p">(</span><span class="ss">branch: </span><span class="s1">'mm-ruby-2.1'</span><span class="p">)</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>repository_id</td>
<td>id of the repository the cache belongs to</td>
</tr>
<tr>
<td>size</td>
<td>compressed cache size in bytes</td>
</tr>
<tr>
<td>slug</td>
<td>cache slug (generated from env)</td>
</tr>
<tr>
<td>branch</td>
<td>branch the cache is for</td>
</tr>
<tr>
<td>last_modified</td>
<td>last time the cache was updated</td>
</tr>
</tbody></table>

<h3 id="list-caches">List caches</h3>

<p><code class="prettyprint">GET /repos/{repository.id}/caches</code></p>

<p><code class="prettyprint">GET /repos/{+repository.slug}/caches</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>branch</td>
<td></td>
<td>limit listed caches to those on given branch</td>
</tr>
<tr>
<td>match</td>
<td></td>
<td>limit listed caches to those with <code class="prettyprint">slug</code> containing the given value</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h3 id="delete-caches">Delete caches</h3>

<p><code class="prettyprint">DELETE /repos/{repository.id}/caches</code></p>

<p><code class="prettyprint">DELETE /repos/{+repository.slug}/caches</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>branch</td>
<td></td>
<td>only delete caches on given branch</td>
</tr>
<tr>
<td>match</td>
<td></td>
<td>only delete caches with <code class="prettyprint">slug</code> containing the given value</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h2 id="commits">Commits</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/sinatra/sinatra/builds</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"builds"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"jobs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"commits"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1873023</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sha"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a18f211f6f921affd1ecd8c18691b40d9948aae5"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"branch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"master"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Merge pull request #25 from henrikhodne/add-responses-to-documentation\n\nAdd responses to documentation"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"committed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-04-15T09:44:31Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"author_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Henrik Hodne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"author_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"me@henrikhodne.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"committer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Henrik Hodne"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"committer_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"me@henrikhodne.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"compare_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://github.com/travis-ci/travis-api/compare/0f31ff4fb6aa...a18f211f6f92"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis <span class="nb">history</span> -r sinatra/sinatra
<span class="c">#784 failed:     master Merge pull request #861 from kant/patch-1</span>
<span class="c">#783 passed:     v1.4.5 v1.4.5</span>
<span class="c">#782 passed:     master v1.4.5</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="n">repository</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">)</span>
<span class="n">repository</span><span class="p">.</span><span class="nf">each_build</span> <span class="k">do</span> <span class="o">|</span><span class="n">build</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">build</span><span class="p">.</span><span class="nf">commit</span><span class="p">.</span><span class="nf">message</span>
<span class="k">end</span>
</pre>

<p>There is no API endpoint for resolving commits, however commit data might be included in other API responses, like <a href="#builds">builds</a> or <a href="#jobs">jobs</a>.</p>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>commit id</td>
</tr>
<tr>
<td>sha</td>
<td>commit sha</td>
</tr>
<tr>
<td>branch</td>
<td>branch the commit is on</td>
</tr>
<tr>
<td>message</td>
<td>commit message</td>
</tr>
<tr>
<td>committed_at</td>
<td>commit date</td>
</tr>
<tr>
<td>author_name</td>
<td>author name</td>
</tr>
<tr>
<td>author_email</td>
<td>author email</td>
</tr>
<tr>
<td>committer_name</td>
<td>committer name</td>
</tr>
<tr>
<td>committer_email</td>
<td>committer email</td>
</tr>
<tr>
<td>compare_url</td>
<td>link to diff on GitHub</td>
</tr>
</tbody></table>

<h2 id="hooks">Hooks</h2>
<pre class="highlight http"><span class="nf">PUT</span> <span class="nn">/hooks</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"hook"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
    </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis <span class="nb">enable</span> -r my/repo
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">hooks</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">hook</span><span class="o">|</span> <span class="n">hook</span><span class="p">.</span><span class="nf">enable</span> <span class="p">}</span>
</pre>

<h3 id="attributes">Attributes</h3>

<p>See <a href="#repositories">repository</a>.</p>

<h3 id="list-hooks">List Hooks</h3>

<p><code class="prettyprint">GET /hooks</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="enable/disable-hook">Enable/Disable Hook</h3>

<p><code class="prettyprint">PUT /hooks</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>hook[id]</td>
<td></td>
<td>id of the hook/repository</td>
</tr>
<tr>
<td>hook[active]</td>
<td>false</td>
<td>whether to turn hook on (true) or off (false)</td>
</tr>
</tbody></table>

<p><code class="prettyprint">PUT /hooks/{hook.id}</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>hook[active]</td>
<td>false</td>
<td>whether to turn hook on (true) or off (false)</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h2 id="jobs">Jobs</h2>
<pre class="highlight http"><span class="nf">POST</span> <span class="nn">/jobs/42/restart</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight shell"><span class="gp">$ </span>travis restart 1.2 -r my/repo
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>

<span class="no">Travis</span><span class="p">.</span><span class="nf">repos</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">).</span><span class="nf">last_build</span><span class="p">.</span><span class="nf">jobs</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">job</span><span class="o">|</span>
  <span class="n">job</span><span class="p">.</span><span class="nf">restart</span> <span class="k">if</span> <span class="n">job</span><span class="p">.</span><span class="nf">failed?</span>
<span class="k">end</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>job id</td>
</tr>
<tr>
<td>build_id</td>
<td>build id</td>
</tr>
<tr>
<td>repository_id</td>
<td>repository id</td>
</tr>
<tr>
<td>commit_id</td>
<td>commit id</td>
</tr>
<tr>
<td>log_id</td>
<td>log id</td>
</tr>
<tr>
<td>number</td>
<td>job number</td>
</tr>
<tr>
<td>config</td>
<td>job config (secure values and ssh key removed)</td>
</tr>
<tr>
<td>state</td>
<td>job state</td>
</tr>
<tr>
<td>started_at</td>
<td>time the job was started</td>
</tr>
<tr>
<td>finished_at</td>
<td>time the job finished</td>
</tr>
<tr>
<td>queue</td>
<td>job queue</td>
</tr>
<tr>
<td>allow_failure</td>
<td>whether or not job state influences build state</td>
</tr>
<tr>
<td>annotation_ids</td>
<td>list of annotation ids</td>
</tr>
</tbody></table>

<h3 id="fetch-job">Fetch Job</h3>

<p><code class="prettyprint">GET /jobs/{job.id}</code></p>

<h3 id="fetch-multiple-jobs">Fetch multiple jobs</h3>

<p><aside class='notice'>Job entities are included in build payloads.</aside></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td></td>
<td>list of job ids</td>
</tr>
<tr>
<td>state</td>
<td></td>
<td>job state to filter by</td>
</tr>
<tr>
<td>queue</td>
<td></td>
<td>job queue to filter by</td>
</tr>
</tbody></table>

<p>You need to provide exactly one of the above parameters.
If you provide <code class="prettyprint">state</code> or <code class="prettyprint">queue</code>, a maximum of 250 jobs will be returned.</p>

<h3 id="cancel-job">Cancel Job</h3>

<p><code class="prettyprint">POST /jobs/{job.id}/cancel</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="restart-job">Restart Job</h3>

<p><code class="prettyprint">POST /jobs/{job.id}/restart</code></p>

<p>This request always needs to be authenticated.</p>

<h2 id="logs">Logs</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/jobs/42/logs</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/plain</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="s">Content-Type text/plain</span>

Using worker: ...
</pre>
<pre class="highlight shell"><span class="gp">$ </span>travis logs
... logs ...
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="n">rails</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'rails/rails'</span><span class="p">)</span>
<span class="n">job</span>   <span class="o">=</span> <span class="n">rails</span><span class="p">.</span><span class="nf">last_build</span><span class="p">.</span><span class="nf">jobs</span><span class="p">.</span><span class="nf">first</span>

<span class="c1"># this will live stream if the job is currently running</span>
<span class="n">job</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="nf">body</span> <span class="k">do</span> <span class="o">|</span><span class="n">part</span><span class="o">|</span>
  <span class="nb">print</span> <span class="n">part</span>
<span class="k">end</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>log id</td>
</tr>
<tr>
<td>job_id</td>
<td>job id</td>
</tr>
<tr>
<td>body</td>
<td>log body</td>
</tr>
</tbody></table>

<h3 id="chunked-attributes">Chunked Attributes</h3>

<p>You can retrieve the chunked attributes instead of the normal attributes by adding the attribute <code class="prettyprint">chunked=true</code> to the mime-type specified in the <code class="prettyprint">Accept</code> header.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>log id</td>
</tr>
<tr>
<td>job_id</td>
<td>job id</td>
</tr>
<tr>
<td>parts</td>
<td>log parts</td>
</tr>
</tbody></table>

<p>The <code class="prettyprint">parts</code> will be an array of JSON objects with the following attributes:</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td>part number</td>
</tr>
<tr>
<td>content</td>
<td>part content</td>
</tr>
</tbody></table>

<h3 id="fetching-a-log">Fetching a Log</h3>

<p><code class="prettyprint">GET /logs/{log.id}</code></p>

<h3 id="fetching-logs-as-plain-text">Fetching Logs as plain text</h3>

<p><aside class='warning'>The response will not be JSON but plain text.</aside></p>

<p><code class="prettyprint">GET /jobs/{job.id}/logs</code></p>

<p>This might be necessary if the log has been archived, in which case it will result in a redirect.</p>

<h3 id="streaming-logs">Streaming Logs</h3>

<p>To stream the logs, you will have to subscribe to the channel for the job the log belongs to on Pusher (channel is <code class="prettyprint">job-{job.id}</code>) and listen for <code class="prettyprint">job:log</code> events. The payload will have the same format as parts have in the chunked attributes API payloads.</p>

<h2 id="permissions">Permissions</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/users/permissions</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"permissions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w">
  </span><span class="s2">"admin"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
  </span><span class="s2">"pull"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"push"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis repos

</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>

<span class="no">Travis</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">push_access</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">repo</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"has push access to </span><span class="si">#{</span><span class="n">repo</span><span class="p">.</span><span class="nf">slug</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</pre>

<p>The permissions endpoint will return arrays of repository ids:</p>

<table><thead>
<tr>
<th>Key</th>
<th>ids for</th>
</tr>
</thead><tbody>
<tr>
<td>permissions</td>
<td>repositories the user has access to</td>
</tr>
<tr>
<td>admin</td>
<td>repositories the user has admin access to</td>
</tr>
<tr>
<td>pull</td>
<td>repositories the user has pull access to</td>
</tr>
<tr>
<td>push</td>
<td>repositories the user has push access to</td>
</tr>
</tbody></table>

<p>The pull access list is only relevant for private projects.</p>

<h3 id="fetch-permissions">Fetch Permissions</h3>

<p><code class="prettyprint">GET /users/permissions</code></p>

<p>This request always needs to be authenticated.</p>

<h2 id="repository-keys">Repository Keys</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/sinatra/sinatra/key</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----BEGIN RSA PUBLIC KEY-----\\nMIGJAoGBAOcx131amMqIzm5+FbZz+DhIgSDbFzjKKpzaN5UWVCrLSc57z64xxTV6\\nkaOTZmjCWz6WpaPkFZY+czfL7lmuZ/Y6UNm0vupvdZ6t27SytFFGd1/RJlAe89tu\\nGcIrC1vtEvQu2frMLvHqFylnGd5Gy64qkQT4KRhMsfZctX4z5VzTAgMBAAE=\\n-----END RSA PUBLIC KEY-----\\n"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ef:39:56:6e:2a:09:a2:10:2e:b5:39:ac:3d:3e:e1:05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis pubkey -r travis-ci/travis-api
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQCOmOkC6MYRH1w2ib3AIC00GNwmgr8ch3mNHZ16x6cvSMjc6cURZt9Hav6gz03P5+9e5Vw1ztm3hvPR+IJsyOV/CSsYf1Cgboj6ZJ7tr3xOJXcqcMVfiGiG7Km6/psRdn0jrjTpU/qcru8Wx3zbQEf5NuXQyMVHmnl8/5w0WPV/Uw<span class="o">==</span>

<span class="gp">$ </span>travis pubkey --pem -r travis-ci/travis-api
-----BEGIN RSA PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOmOkC6MYRH1w2ib3AIC00GNwm
gr8ch3mNHZ16x6cvSMjc6cURZt9Hav6gz03P5+9e5Vw1ztm3hvPR+IJsyOV/CSsY
f1Cgboj6ZJ7tr3xOJXcqcMVfiGiG7Km6/psRdn0jrjTpU/qcru8Wx3zbQEf5NuXQ
yMVHmnl8/5w0WPV/UwIDAQAB
-----END RSA PUBLIC KEY-----

<span class="gp">$ </span>travis pubkey --fingerprint -r travis-ci/travis-api
99:66:93:03:41:0b:f1:f7:61:83:16:61:fa:47:c0:8f
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="n">repo</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'travis-ci/travis-api'</span><span class="p">)</span>

<span class="nb">puts</span> <span class="s2">"SSH format:  "</span><span class="p">,</span> <span class="n">repo</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">to_ssh</span>
<span class="nb">puts</span> <span class="s2">"PEM format:  "</span><span class="p">,</span> <span class="n">repo</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">to_s</span>
<span class="nb">puts</span> <span class="s2">"Fingerprint: "</span><span class="p">,</span> <span class="n">repo</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">fingerprint</span>
<span class="nb">puts</span> <span class="n">repository</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="s2">"example"</span><span class="p">)</span>
</pre>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>public key</td>
</tr>
<tr>
<td>fingerprint</td>
<td>fingerprint for the public key</td>
</tr>
</tbody></table>

<p>This key can be used to encrypt (but not decrypt) secure env vars.</p>

<h3 id="fetch-a-public-key">Fetch a Public Key</h3>

<p><code class="prettyprint">GET /repos/{repository.id}/key</code></p>

<p><code class="prettyprint">GET /repos/{+repository.slug}/key</code></p>

<h3 id="generate-a-public-key">Generate a Public Key</h3>

<p><code class="prettyprint">POST /repos/{repository.id}/key</code></p>

<p><code class="prettyprint">POST /repos/{+repository.slug}/key</code></p>

<p>This will invalidate the current key, thus also rendering all encrypted variables invalid.</p>

<p>This request always needs to be authenticated.</p>

<h2 id="repositories">Repositories</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/sinatra/sinatra</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"repo"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">82</span><span class="p">,</span><span class="w">
    </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sinatra/sinatra"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Classy web-development dressed in a DSL"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_build_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">23436881</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_build_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"792"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_build_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_build_duration"</span><span class="p">:</span><span class="w"> </span><span class="mi">2542</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_build_started_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-21T15:27:14Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_build_finished_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-21T15:40:04Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"github_language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ruby"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis show -r travis-ci/travis-api
...
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="n">repos</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find_all</span><span class="p">(</span><span class="ss">owner_name: </span><span class="s1">'sinatra'</span><span class="p">)</span>
<span class="n">repos</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">repo</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">repo</span><span class="p">.</span><span class="nf">slug</span>
<span class="k">end</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>repository id</td>
</tr>
<tr>
<td>slug</td>
<td>repository slug</td>
</tr>
<tr>
<td>description</td>
<td>description on githu</td>
</tr>
<tr>
<td>last_build_id</td>
<td>build id of the last build</td>
</tr>
<tr>
<td>last_build_number</td>
<td>build number of the last build</td>
</tr>
<tr>
<td>last_build_state</td>
<td>build state of the last build</td>
</tr>
<tr>
<td>last_build_duration</td>
<td>build duration of the last build</td>
</tr>
<tr>
<td>last_build_started_at</td>
<td>build started at of the last build</td>
</tr>
<tr>
<td>last_build_finished_at</td>
<td>build finished at of the last build</td>
</tr>
<tr>
<td>github_language</td>
<td>language on github</td>
</tr>
</tbody></table>

<h3 id="fetch-repository">Fetch Repository</h3>

<p><code class="prettyprint">GET /repos/{repository.id}</code></p>

<p><code class="prettyprint">GET /repos/{+repository.slug}</code></p>

<h3 id="find-repositories">Find Repositories</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td></td>
<td>list of repository ids to fetch, cannot be combined with other parameters</td>
</tr>
<tr>
<td>member</td>
<td></td>
<td>filter by user that has access to it (github login)</td>
</tr>
<tr>
<td>owner_name</td>
<td></td>
<td>filter by owner name (first segment of slug)</td>
</tr>
<tr>
<td>slug</td>
<td></td>
<td>filter by slug</td>
</tr>
<tr>
<td>search</td>
<td></td>
<td>filter by search term</td>
</tr>
<tr>
<td>active</td>
<td><code class="prettyprint">false</code></td>
<td>if <code class="prettyprint">true</code>, will only return repositories that are enabled</td>
</tr>
</tbody></table>

<p>If no parameters are given, a list or repositories with recent activity is returned.</p>

<h2 id="requests">Requests</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/requests/6301283</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6301283</span><span class="p">,</span><span class="w">
    </span><span class="s2">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1121945</span><span class="p">,</span><span class="w">
    </span><span class="s2">"commit_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5904016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-08T15:54:07Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"owner_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4279</span><span class="p">,</span><span class="w">
    </span><span class="s2">"owner_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Organization"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"push"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"accepted"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pull_request"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"branch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"feat-container-injector"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"commit"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5904016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sha"</span><span class="p">:</span><span class="w"> </span><span class="s2">"09e2ce14f1debea64a1122851fc3f8f1c1a18ebc"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"branch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"feat-container-injector"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don't inject the service_container"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"committed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-08T15:53:42Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"author_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sebastiaan Stok"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"author_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s.stok@rollerscapes.net"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"committer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sebastiaan Stok"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"committer_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s.stok@rollerscapes.net"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"compare_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://github.com/..."</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis requests -r my/repo
...
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'sinatra/sinatra'</span><span class="p">).</span><span class="nf">requests</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">request</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">request</span><span class="p">.</span><span class="nf">commit</span><span class="p">.</span><span class="nf">sha</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">request</span><span class="p">.</span><span class="nf">result</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</pre>

<p>Requests can be used to see if and why a GitHub event has or has not triggered a new build.</p>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>request id</td>
</tr>
<tr>
<td>commit_id</td>
<td>commit id</td>
</tr>
<tr>
<td>repository_id</td>
<td>repository id</td>
</tr>
<tr>
<td>created_at</td>
<td>created at</td>
</tr>
<tr>
<td>owner_id</td>
<td>owner id</td>
</tr>
<tr>
<td>owner_type</td>
<td>owner type (<code class="prettyprint">&quot;User&quot;</code> or <code class="prettyprint">&quot;Organization&quot;</code>)</td>
</tr>
<tr>
<td>event_type</td>
<td>event type (<code class="prettyprint">&quot;push&quot;</code> or <code class="prettyprint">&quot;pull_request&quot;</code>)</td>
</tr>
<tr>
<td>base_commit</td>
<td>base commit for pull requests</td>
</tr>
<tr>
<td>head_commit</td>
<td>head commit for pull requests</td>
</tr>
<tr>
<td>result</td>
<td><code class="prettyprint">&quot;accepted&quot;</code>, <code class="prettyprint">&quot;rejected&quot;</code> or <code class="prettyprint">null</code></td>
</tr>
<tr>
<td>message</td>
<td>human readable message explaining why event has been rejected</td>
</tr>
<tr>
<td>pull_request</td>
<td><code class="prettyprint">true</code> or <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>pull_request_number</td>
<td>pull request number</td>
</tr>
<tr>
<td>pull_request_title</td>
<td>pull request title</td>
</tr>
<tr>
<td>branch</td>
<td>branch commit is on</td>
</tr>
<tr>
<td>tag</td>
<td>tag if commit has been tagged</td>
</tr>
</tbody></table>

<h3 id="show-request">Show Request</h3>

<p><code class="prettyprint">GET /requests/{request.id}</code></p>

<h3 id="list-requests">List Requests</h3>

<p><code class="prettyprint">GET /requests</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>repository_id</td>
<td></td>
<td>repository id the requests belong to</td>
</tr>
<tr>
<td>slug</td>
<td></td>
<td>repository slug the requests belong to</td>
</tr>
<tr>
<td>limit</td>
<td>25</td>
<td>maximum number of requests to return (cannot be larger than 100)</td>
</tr>
<tr>
<td>older_than</td>
<td></td>
<td>list requests before <code class="prettyprint">older_than</code> (with <code class="prettyprint">older_than</code> being a request id)</td>
</tr>
</tbody></table>

<p>You have to either provide <code class="prettyprint">repository_id</code> or <code class="prettyprint">slug</code>.</p>

<h2 id="settings:-general">Settings: General</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/repos/82/settings</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"settings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"builds_only_with_travis_yml"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"build_pushes"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"build_pull_requests"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"maximum_number_of_builds"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis settings
Settings <span class="k">for </span>travis-ci/travis-api:
<span class="o">[</span>-] builds_only_with_travis_yml    Only run builds with a .travis.yml
<span class="o">[</span>+] build_pushes                   Build pushes
<span class="o">[</span>+] build_pull_requests            Build pull requests
  0 maximum_number_of_builds       Maximum number of concurrent builds

<span class="gp">$ </span>travis settings build_pull_requests --enable
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="n">repo</span> <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">)</span>
<span class="n">repo</span><span class="p">.</span><span class="nf">settings</span><span class="p">.</span><span class="nf">build_pull_requests</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">repo</span><span class="p">.</span><span class="nf">settings</span><span class="p">.</span><span class="nf">save</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>builds_only_with_travis_yml</td>
<td>&ldquo;builds only with .travis.yml&rdquo; setting (<code class="prettyprint">true</code> or <code class="prettyprint">false</code>)</td>
</tr>
<tr>
<td>build_pushes</td>
<td>&ldquo;build pushes&rdquo; setting (<code class="prettyprint">true</code> or <code class="prettyprint">false</code>)</td>
</tr>
<tr>
<td>build_pull_requests</td>
<td>&ldquo;build pull requests&rdquo; setting (<code class="prettyprint">true</code> or <code class="prettyprint">false</code>)</td>
</tr>
<tr>
<td>maximum_number_of_builds</td>
<td>&ldquo;maximum number of concurrent builds&rdquo; setting (integer)</td>
</tr>
</tbody></table>

<h3 id="retrieve-settings">Retrieve Settings</h3>

<p><code class="prettyprint">GET /repos/{repository.id}/settings</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="update-settings">Update Settings</h3>

<p><code class="prettyprint">PATCH /repos/{repository.id}/settings</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>settings</td>
<td><code class="prettyprint">{}</code></td>
<td>Hash map of settings that should be updated and their new values (see Attributes)</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h2 id="settings:-environment-variables">Settings: Environment Variables</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/settings/env_vars?repository_id=124920</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"env_vars"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"018e66f2-cd3a-4295-aa1d-018fe9aa0fb4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foobar"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"public"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">124920</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ec9423da-9658-4cd6-b282-fd0e5f6ed2df"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret_example"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"public"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"repository_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">124920</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis env list
<span class="nv">example</span><span class="o">=</span>foobar
<span class="nv">secret_example</span><span class="o">=[</span>secure]
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span>  <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="n">repo</span>                 <span class="o">=</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">)</span>
<span class="n">repo</span><span class="p">.</span><span class="nf">env_vars</span><span class="o">[</span><span class="s1">'foo'</span><span class="o">]</span> <span class="o">=</span> <span class="n">bar</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>env var id</td>
</tr>
<tr>
<td>repository_id</td>
<td>repository id</td>
</tr>
<tr>
<td>name</td>
<td>env var name (exported)</td>
</tr>
<tr>
<td>value</td>
<td>env var value (exported, only included if public is true)</td>
</tr>
<tr>
<td>public</td>
<td>whether or not value is public</td>
</tr>
</tbody></table>

<h3 id="list-variables">List Variables</h3>

<p><code class="prettyprint">GET /settings/env_vars?repository_id={repository.id}</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="fetch-variable">Fetch Variable</h3>

<p><code class="prettyprint">GET /settings/env_vars/{env_var.id}?repository_id={repository.id}</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="add-variable">Add Variable</h3>

<p><code class="prettyprint">POST /settings/env_vars?repository_id={repository.id}</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>env_var</td>
<td></td>
<td>Hash map of env var variable (see below)</td>
</tr>
<tr>
<td>env_var.name</td>
<td></td>
<td>Name of the new env var (string)</td>
</tr>
<tr>
<td>env_var.value</td>
<td></td>
<td>Value of the new env var (string)</td>
</tr>
<tr>
<td>env_var.public</td>
<td>false</td>
<td>whether or not to display the value</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h3 id="update-variable">Update Variable</h3>

<p><code class="prettyprint">PATCH /settings/env_vars/{env_var.id}?repository_id={repository.id}</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>env_var</td>
<td></td>
<td>Hash map of env var variable (see below)</td>
</tr>
<tr>
<td>env_var.name</td>
<td>current value</td>
<td>Name of the new env var (string)</td>
</tr>
<tr>
<td>env_var.value</td>
<td>current value</td>
<td>Value of the new env var (string)</td>
</tr>
<tr>
<td>env_var.public</td>
<td>current value</td>
<td>whether or not to display the value</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h3 id="delete-variable">Delete Variable</h3>

<p><code class="prettyprint">DELETE /settings/env_vars/{env_var.id}?repository_id={repository.id}</code></p>

<p>This request always needs to be authenticated.</p>

<h2 id="settings:-ssh-key">Settings: SSH Key</h2>

<p><aside class="notice">
This API is only available on Travis Pro.
</aside></p>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/settings/ssh_key/124920</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.com</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"ssh_key"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my custom key"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"99:66:93:03:41:0b:f1:f7:61:83:16:61:fa:47:c0:8f"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis sshkey
No custom SSH key installed.
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis/pro'</span>
<span class="no">Travis</span><span class="o">::</span><span class="no">Pro</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="nb">puts</span> <span class="no">Travis</span><span class="o">::</span><span class="no">Pro</span><span class="o">::</span><span class="no">Repository</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'my/repo'</span><span class="p">).</span><span class="nf">ssh_key</span><span class="p">.</span><span class="nf">description</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ssh key id (corresponds to repository id)</td>
</tr>
<tr>
<td>description</td>
<td>key description</td>
</tr>
<tr>
<td>fingerprint</td>
<td>key fingerprint</td>
</tr>
</tbody></table>

<h3 id="fetch-key">Fetch Key</h3>

<p><code class="prettyprint">GET /settings/ssh_key/#{ssh_key.id}</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="update-or-create-key">Update or Create Key</h3>

<p><code class="prettyprint">PATCH /settings/ssh_key/#{ssh_key.id}</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ssh_key</td>
<td></td>
<td>Hash map of ssh key data (see below)</td>
</tr>
<tr>
<td>ssh_key.description</td>
<td>current value or empty</td>
<td>key description</td>
</tr>
<tr>
<td>ssh_key.value</td>
<td></td>
<td>private key (required)</td>
</tr>
</tbody></table>

<p>This request always needs to be authenticated.</p>

<h3 id="delete-key">Delete Key</h3>

<p><code class="prettyprint">DELETE /settings/ssh_key/#{ssh_key.id}</code></p>

<p>This request always needs to be authenticated.</p>

<h2 id="users">Users</h2>
<pre class="highlight http"><span class="nf">GET</span> <span class="nn">/users/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">token YOUR TRAVIS ACCESS TOKEN</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">267</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Konstantin Haase"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"login"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rkh"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"github@rkh.im"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gravatar_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5c2b452f6eea4a6d84c105ebd971d2a4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_syncing"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"synced_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-27T18:53:43Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"correct_scopes"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2011-03-30T16:25:21Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis whoami
You are rkh <span class="o">(</span>Konstantin Haase<span class="o">)</span>

<span class="gp">$ </span>travis sync
synchronizing: ... <span class="k">done</span>
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">access_token</span> <span class="o">=</span> <span class="s1">'YOUR TRAVIS ACCESS TOKEN'</span>
<span class="nb">puts</span> <span class="no">Travis</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">name</span>
<span class="no">Travis</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">sync</span>
</pre>

<h3 id="attributes">Attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>user id</td>
</tr>
<tr>
<td>login</td>
<td>user login on github</td>
</tr>
<tr>
<td>name</td>
<td>user name  on github</td>
</tr>
<tr>
<td>email</td>
<td>primary email address on github</td>
</tr>
<tr>
<td>gravatar_id</td>
<td>avatarid</td>
</tr>
<tr>
<td>is_syncing</td>
<td>whether or not user account is currently being synced</td>
</tr>
<tr>
<td>synced_at</td>
<td>last synced at</td>
</tr>
<tr>
<td>correct_scopes</td>
<td>whether or not github token has the correct scopes</td>
</tr>
<tr>
<td>channels</td>
<td>pusher channels for this user</td>
</tr>
</tbody></table>

<h3 id="show-user">Show User</h3>

<p><code class="prettyprint">GET /users/</code></p>

<p><code class="prettyprint">GET /users/{user.id}</code></p>

<p>This request always needs to be authenticated.</p>

<h3 id="sync-users">Sync Users</h3>

<p><code class="prettyprint">POST /users/sync</code></p>

<p>Triggers a new sync with GitHub. Might return status <code class="prettyprint">409</code> if the user is currently syncing.</p>

<p>This request always needs to be authenticated.</p>

<h1 id="other-endpoints">Other Endpoints</h1>

<h2 id="linting">Linting</h2>
<pre class="highlight http"><span class="nf">PUT</span> <span class="nn">/lint/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/vnd.travis-ci.2+json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.travis-ci.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/yaml</span>

language: ruby
jdk: default
</pre>
<pre class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"lint"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"warnings"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"jdk"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"specified jdk, but ruby does not include jruby"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<pre class="highlight shell"><span class="gp">$ </span>travis lint example.yml
Warnings <span class="k">for </span>example.yml:
<span class="o">[</span>x] dropping jdk section: specified jdk, but ruby does not include jruby
</pre>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'travis'</span>

<span class="n">content</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="no">YAML</span><span class="sh">
  language: ruby
  jdk: default
</span><span class="no">YAML</span>

<span class="no">Travis</span><span class="p">.</span><span class="nf">lint</span><span class="p">(</span><span class="n">content</span><span class="p">).</span><span class="nf">warnings</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">warning</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"%p: %s"</span> <span class="o">%</span> <span class="o">[</span><span class="n">warning</span><span class="p">.</span><span class="nf">key</span><span class="p">,</span> <span class="n">warning</span><span class="p">.</span><span class="nf">message</span><span class="o">]</span>
<span class="k">end</span>
</pre>

<p><code class="prettyprint">POST /lint</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>content</td>
<td></td>
<td>content of the <code class="prettyprint">.travis.yml</code></td>
</tr>
</tbody></table>

<p><code class="prettyprint">PUT /lint</code></p>

<p>This is an alternative endpoint to the <code class="prettyprint">POST</code> with parameter, to make it work well with tools like <code class="prettyprint">curl</code> (<code class="prettyprint">curl -T .travis.yml api.travis-ci.org/lint</code>). The request body can contain the YAML file directly.</p>

<h1 id="api-clients">API Clients</h1>

<p>There are a few API clients out there you can use for interacting with the Travis API, rather than manually triggering HTTP requests and parsing the responses.</p>

<h2 id="official">Official</h2>

<p>The following clients are maintained by the Travis CI team:</p>

<ul>
<li><strong><a href="https://github.com/travis-ci/travis.rb">travis.rb</a></strong>: Command line client and Ruby library</li>
<li><strong><a href="https://github.com/travis-ci/travis-web">travis-web</a></strong>: Web interface and JavaScript library, using Ember.js</li>
<li><strong><a href="https://github.com/travis-ci/travis-sso">travis-sso</a></strong>: Single-Sign-On Rack middleware for Travis CI applications</li>
</ul>

<h2 id="web-browsers">Web Browsers</h2>

<blockquote>
<p>API requests using CORS:</p>
</blockquote>
<pre class="highlight html"><span class="nt">&lt;script&gt;</span>
  <span class="c1">// using XMLHttpRequest or XDomainRequest to send an API request
</span>  <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">XDomainRequest</span> <span class="p">?</span> <span class="k">new</span> <span class="nx">XDomainRequest</span><span class="p">()</span> <span class="p">:</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"https://api.travis-ci.org/"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"it worked!"</span><span class="p">)</span> <span class="p">};</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">"Accept"</span><span class="p">,</span> <span class="s2">"application/vnd.travis-ci.2+json"</span><span class="p">);</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
  <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</pre>

<blockquote>
<p>With jQuery:</p>
</blockquote>
<pre class="highlight html"><span class="nt">&lt;script&gt;</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">"https://api.travis-ci.org/"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> <span class="na">Accept</span><span class="p">:</span> <span class="s2">"application/vnd.travis-ci.2+json"</span> <span class="p">},</span>
  <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"it worked!"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre>

<blockquote>
<p>JSONP</p>
</blockquote>
<pre class="highlight html"><span class="nt">&lt;script&gt;</span>
  <span class="kd">function</span> <span class="nx">jsonpCallback</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"it worked!"</span><span class="p">)</span> <span class="p">};</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://api.travis-ci.org/?callback=jsonpCallback"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre>

<p>When writing an in-browser client, you have to circumvent the browser&rsquo;s
<a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy</a>.
Generally, we offer two different approaches for this:
<a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross-Origin Resource Sharing</a> (aka CORS)
and <a href="http://en.wikipedia.org/wiki/JSONP">JSONP</a>. If you don&rsquo;t have any good
reason for using JSONP, we recommend you use CORS.</p>

<h3 id="cross-origin-resource-sharing">Cross-Origin Resource Sharing</h3>

<p>All API resources set appropriate headers to allow Cross-Origin requests. Be
aware that on Internet Explorer you might have to use a different interface to
send these requests.</p>

<p>In contrast to JSONP, CORS does not lead to any execution of untrusted code.</p>

<p>Most JavaScript frameworks, like <a href="http://jquery.com">jQuery</a>, take care of CORS
requests for you under the hood, so you can just do a normal <em>ajax</em> request.</p>

<p>Our current setup allows the headers <code class="prettyprint">Content-Type</code>, <code class="prettyprint">Authorization</code>, <code class="prettyprint">Accept</code> and the HTTP methods <code class="prettyprint">HEAD</code>, <code class="prettyprint">GET</code>, <code class="prettyprint">POST</code>, <code class="prettyprint">PATCH</code>, <code class="prettyprint">PUT</code>, <code class="prettyprint">DELETE</code>.</p>

<h3 id="jsonp">JSONP</h3>

<p>You can disable the same origin policy by treating the response as JavaScript.
Supply a <code class="prettyprint">callback</code> parameter to use this.</p>

<p>This has the potential of code injection, use with caution.</p>

<h2 id="third-party">Third Party</h2>

<p>Besides the official clients, there is a range of third party client available, amongst these:</p>

<ul>
<li><strong><a href="https://github.com/l3l0/php-travis-client">PHP Travis Client</a></strong>: PHP client library</li>
<li><strong><a href="https://github.com/pwmckenna/node-travis-ci">Travis Node.js</a></strong>: Node.js client library</li>
<li><strong><a href="https://github.com/cmaujean/travis-api-wrapper">travis-api-wrapper</a></strong>: Asynchronous Node.js wrapper</li>
<li><strong><a href="https://github.com/mmalecki/node-travis-ci">travis-ci</a></strong>: Thin Node.js wrapper</li>
<li><strong><a href="https://github.com/smcintosh/travisminer">TravisMiner</a></strong>: Ruby library for mining the Travis API</li>
<li><strong><a href="http://travispy.readthedocs.org/en/latest/">TravisPy</a></strong>: Python library trying to closely mimic the official Ruby client</li>
</ul>


      </div>
      <div class="dark-box">
        <div id="lang-selector">



                <a href="#" data-language-name="http" data-proofer-ignore>http</a>



                <a href="#" data-language-name="shell" data-proofer-ignore>shell</a>



                <a href="#" data-language-name="ruby" data-proofer-ignore>ruby</a>



        </div>
      </div>
    </div>
  </body>
</html>
